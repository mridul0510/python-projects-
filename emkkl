<!DOCTYPE html>
<html>
<head>
    <title>Export Table - Email, Clipboard & CSV</title>
    <script>
        // Extract table data as plain text
        function getTableDataPlain() {
            const table = document.getElementById("dataTable");
            let output = "Exported Table Data:\n\n";

            for (let i = 0; i < table.rows.length; i++) {
                const row = table.rows[i];
                for (let j = 0; j < row.cells.length; j++) {
                    output += row.cells[j].innerText + "\t";
                }
                output += "\n";
            }

            return output;
        }

        // Extract table data as CSV
        function getTableDataCSV() {
            const table = document.getElementById("dataTable");
            let csv = "";

            for (let i = 0; i < table.rows.length; i++) {
                const row = table.rows[i];
                let rowData = [];
                for (let j = 0; j < row.cells.length; j++) {
                    rowData.push('"' + row.cells[j].innerText + '"');
                }
                csv += rowData.join(",") + "\n";
            }

            return csv;
        }

        // Export to email
        function exportToOutlook() {
            const data = getTableDataPlain();
            const subject = encodeURIComponent("Exported Webpage Table");
            const body = encodeURIComponent(data);
            const mailtoLink = `mailto:?subject=${subject}&body=${body}`;
            window.location.href = mailtoLink;
        }

        // Copy to clipboard
        function copyToClipboard() {
            const text = getTableDataPlain();
            navigator.clipboard.writeText(text).then(() => {
                alert("Table data copied to clipboard!");
            }).catch(err => {
                alert("Failed to copy: " + err);
            });
        }

        // Download as CSV
        function downloadCSV() {
            const csvData = getTableDataCSV();
            const blob = new Blob([csvData], { type: "text/csv;charset=utf-8;" });
            const url = URL.createObjectURL(blob);

            const a = document.createElement("a");
            a.href = url;
            a.download = "exported_table.csv";
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>
</head>
<body>

    <h2>Weekly Server Report</h2>

    <table id="dataTable" border="1">
        <tr>
            <th>Server</th>
            <th>Status</th>
            <th>Last Checked</th>
        </tr>
        <tr>
            <td>Server 1</td>
            <td>‚úÖ Running</td>
            <td>16 May 2025</td>
        </tr>
        <tr>
            <td>Server 2</td>
            <td>‚ö†Ô∏è Needs Attention</td>
            <td>16 May 2025</td>
        </tr>
        <tr>
            <td>Server 3</td>
            <td>‚ùå Offline</td>
            <td>16 May 2025</td>
        </tr>
    </table>

    <br>
    <button onclick="exportToOutlook()">üìß Export to Outlook</button>
    <button onclick="copyToClipboard()">üìã Copy to Clipboard</button>
    <button onclick="downloadCSV()">üìÅ Download as CSV</button>

</body>
</html>